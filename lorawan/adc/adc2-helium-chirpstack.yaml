# Home Assistant Package
# LoRaWAN - ADC2
# Helium
# Bridge:
# topic application/# in 0 ""

### ### ###

mqtt:
#2
  sensor:
###4
########### ADC2 ##########
###4
    - name: "LoRa Counter"
      unique_id: ADC2_LoRa_Counter
      state_topic: "application/1/device/70b3d57ed0067bb5/event/up"
      value_template: >
          {% if value_json.fcnt is defined %}
            {{ value_json.fcnt }}
          {% endif %}
      state_class: measurement
      device:
        identifiers: nikito7-ADC2
        name: ADC2
        model: easyhan.pt
        manufacturer: nikito7
###4
    - name: "LoRa Signal"
      unique_id: ADC2_LoRa_Signal
      state_topic: "application/1/device/70b3d57ed0067bb5/event/up"
      value_template: >
        {% if value_json.hotspots is defined %}
          {% if value_json.hotspots.0 is defined %}
          {% set x = value_json.hotspots.0.rssi %}
            {{ x }}
          {% endif %}
        {% endif %}
      state_class: measurement
      device_class: signal_strength
      unit_of_measurement: dBm
      device:
        identifiers: nikito7-ADC2
###4
    - name: "LoRa ADC raw"
      unique_id: ADC2_LoRa_ADC_raw
      state_topic: "application/1/device/70b3d57ed0067bb5/event/up"
      value_template: >
        {% if value_json.decoded is defined %}
          {% if value_json.decoded.payload is defined %}
            {% if value_json.decoded.payload.ADC is defined %}
              {% set x = value_json.decoded.payload.ADC|int(0) %}
              {% if x > -1 %}
                {{ x }}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      state_class: measurement
      device:
        identifiers: nikito7-ADC2
###4
    - name: "LoRa txFail CAD"
      unique_id: ADC2_LoRa_tx_fail_cad
      state_topic: "application/1/device/70b3d57ed0067bb5/event/up"
      value_template: >
        {% if value_json.decoded is defined %}
          {% if value_json.decoded.payload is defined %}
            {% if value_json.decoded.payload.txFail is defined %}
              {% set x = value_json.decoded.payload.txFail|int(0) %}
              {% if x > -1 %}
                {{ x }}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      state_class: measurement
      device:
        identifiers: nikito7-ADC2
###4
###4
    - name: "LoRa Battery Voltage"
      unique_id: ADC2_Battery_Voltage
      state_topic: "application/1/device/70b3d57ed0067bb5/event/up"
      value_template: >
        {% if value_json.decoded is defined %}
          {% if value_json.decoded.payload is defined %}
            {% if value_json.decoded.payload.Volt is defined %}
              {% set x = value_json.decoded.payload.Volt|float(0) %}
              {% if x > 0 %}
                {{ x|round(3) }}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      unit_of_measurement: "V"
      device_class: voltage
      state_class: measurement
      device:
        identifiers: nikito7-ADC2
###4

# EOF
